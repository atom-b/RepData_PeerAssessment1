# Reproducible Research: Peer Assessment 1


## Loading and preprocessing the data

Load the activity data into a data.table (we like data.tables as they're fast), and convert the date column from characters to Dates.

```{r}
library(data.table)
actdata <- fread("activity/activity.csv")
actdata[,date:= as.Date( date, format = "%Y-%m-%d")]
```

## What is mean total number of steps taken per day?
Create a data.table with the sum of steps for each day, excluding any observations missing step data.
```{r, echo=TRUE}
dailySteps <- actdata[!is.na(steps),sum(steps), by=date]
setnames(dailySteps,"V1","daily.steps")
```
<!---
knitr won't preview dailySteps based on a setnames() call, so we do it ourselves
-->
```{r, echo=FALSE}
print(dailySteps, topn=5)
```
### *Make a histogram of the total number of steps taken each day*
```{r dailystephist, echo=TRUE, tidy=FALSE}
hist(dailySteps$daily.steps, 
      breaks = 5,
      col = "cornflowerblue",
      main = "Histogram of Steps Per Day",
      xlab = "Steps Per Day",
      ylab = "Frequency (Days)")
```
### *Calculate and report the mean and median total number of steps taken per day*
```{r dailystepmeanmed, echo=TRUE}
meansteps <- mean(dailySteps$daily.steps)
medsteps <- median(dailySteps$daily.steps)
```
Mean steps per day: **`r meansteps`**

Median steps per day: **`r medsteps`**

## What is the average daily activity pattern?
Create a data.table with the mean of steps for each interval, excluding any observations missing step data.
```{r, echo=TRUE}
intervalSteps <- actdata[!is.na(steps),mean(steps), by=interval]
setnames(intervalSteps,"V1","mean.steps")
```
<!---
knitr won't preview intervalSteps based on a setnames() call, so we do it here
-->
```{r, echo=FALSE}
print(intervalSteps, topn=5)
```

### *A time series plot of the 5-minute interval and the mean steps taken in that interval across all days.*
```{r meanstepsbyinterval, echo=TRUE, tidy=FALSE}
plot(x = intervalSteps$interval, y = intervalSteps$mean.steps,
     type = "l",
      col = "cornflowerblue",
      main = "Mean Steps By Interval",
      xlab = "Interval",
      ylab = "Mean Steps")
```

### *Which 5-minute interval, on average across all the days in the dataset, contains the maximum number of steps?*
```{r, echo=TRUE}
maxinv <- intervalSteps[mean.steps == max(intervalSteps$mean.steps),interval]
```
Interval **`r maxinv`** is has the largest average number of steps.

## Imputing missing values
### *Calculate and report the total number of missing values in the dataset (i.e. the total number of rows with NAs)*
```{r, echo=TRUE}
nrowwithna <- sum(is.na(actdata$steps))
```
There are **`r nrowwithna`** rows with NAs.

### *Create a new dataset that is equal to the original dataset but with the missing data filled in.*
We fill in the missing steps values with the median number of steps for the corresponding interval. A few notes on what this code does:

* The "by = interval" term creates a temporary sub-data.table for each unique interval.
* The ifelse() expression is run within the context of every sub-tables. 
* .SD is a special reference to the sub-table, allowing us to determine the median value of the steps column within each sub table. We set the value of any NA observations to that median.

```{r, echo=TRUE, tidy=FALSE}
actImp <- copy(actdata)
actImp[, steps := ifelse( is.na(steps), 
                          median(.SD$steps, na.rm = TRUE), 
                          steps)
       , by = interval]
```
## Are there differences in activity patterns between weekdays and weekends?
